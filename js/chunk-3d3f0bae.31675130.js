(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d3f0bae"],{"083a":function(t,s,e){"use strict";var i=e("0d51"),a=TypeError;t.exports=function(t,s){if(!delete t[s])throw a("Cannot delete property "+i(s)+" of "+i(t))}},"0fb7":function(t,s,e){},"129d":function(t,s,e){"use strict";e("56f8")},"381e":function(t,s,e){"use strict";e("dc55")},"3c65":function(t,s,e){"use strict";var i=e("23e7"),a=e("7b0b"),o=e("07fa"),n=e("3a34"),r=e("083a"),c=e("3511"),l=1!==[].unshift(0),h=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();i({target:"Array",proto:!0,arity:1,forced:l||h},{unshift:function(t){var s=a(this),e=o(s),i=arguments.length;if(i){c(e+i);var l=e;while(l--){var h=l+i;l in s?s[h]=s[l]:r(s,h)}for(var d=0;d<i;d++)s[d]=arguments[d]}return n(s,e+i)}})},"4e22":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"search"}},[s("div",{staticClass:"search-header"},[s("van-icon",{staticClass:"arrLeft",attrs:{name:"arrow-left"},on:{click:t.goHome}}),s("div",{staticClass:"search-header-vant"},[s("van-search",{attrs:{"show-action":"",placeholder:t.placeholder},on:{search:t.onSearch,cancel:t.onCancel,input:t.onInput},scopedSlots:t._u([{key:"action",fn:function(){return[t.showGoodsList?s("van-icon",{staticClass:"top-car",attrs:{name:"shopping-cart-o",badge:t.badge,size:"30",id:"shop-car"},on:{click:t.goCar}}):s("div",{on:{click:t.onSearch}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.value,callback:function(s){t.value=s},expression:"value"}})],1)],1),[t.showGoodsList?s("div",{staticClass:"goodsList"},[s("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!0},on:{load:t.onLoad},model:{value:t.loading,callback:function(s){t.loading=s},expression:"loading"}},[t._l(t.goodsList,(function(t,e){return[s("Card",{key:e,attrs:{data:t}})]}))],2)],1):s("div",{staticClass:"likeSearch"},[s("van-list",t._l(t.likeSearchList,(function(e,i){return s("van-cell",{key:i,attrs:{title:e},on:{click:function(s){return t.onSearch(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("span",{domProps:{innerHTML:t._s(t.formatHTML(e))}})]},proxy:!0}],null,!0)})})),1)],1)],s("div",{staticClass:"history"},[s("History",{directives:[{name:"show",rawName:"v-show",value:!t.showGoodsList&&t.likeSearchList.length<=0,expression:"!showGoodsList && likeSearchList.length <= 0"}],attrs:{historyList:t.historyList},on:{search:t.onSearch}})],1)],2)},a=[],o=(e("13d5"),e("14d9"),e("3c65"),e("365c")),n=e("ae8d"),r=e("2f62"),c=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"history"}},[s("h4",[t._v("历史记录：")]),t._l(t.historyList,(function(e,i){return s("div",{key:i,staticClass:"item",on:{click:function(s){return t.search(e.value)}}},[t._v(" "+t._s(e.value)+" ")])}))],2)},l=[],h={props:{historyList:{default(){return[]}}},methods:{search(t){this.$emit("search",t)}}},d=h,u=(e("e5a8"),e("2877")),f=Object(u["a"])(d,c,l,!1,null,"29b162de",null),v=f.exports,p={components:{Card:n["a"],History:v},computed:{...Object(r["b"])(["counterMap"]),badge(){let t=Object.values(this.counterMap);return 0===t.length?0:(t=t.reduce((t,s)=>t+s),t)}},data(){return{value:"",placeholder:"苹果",timer:null,likeSearchList:[],loading:!1,finished:!0,goodsList:[],showGoodsList:!1,page:1,size:5,total:0,searchValue:"",historyList:[]}},methods:{goCar(){this.$router.push("/shopping")},goHome(){this.$router.push("/classify")},resetData(){this.likeSearchList=[],this.goodsList=[],this.page=1,this.total=0,this.finished=!1,this.showGoodsList=!1,this.value=""},async getGoodsList(){this.loading=!0;const t=await o["e"](this.value,this.page,this.size);this.loading=!1,this.goodsList=this.goodsList.concat([...t.data.list]),this.total=t.data.total,this.total===this.goodsList.length?this.finished=!0:this.finished=!1},onLoad(){this.page+=1,this.getGoodsList()},onSearch(t){this.resetData(),this.showGoodsList=!0,this.value=t||this.placeholder,this.saveLocalStorage(this.value),this.getGoodsList()},onCancel(){},onInput(){""!==this.value?this.showGoodsList||(this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(async()=>{const t=await o["d"](this.value);this.likeSearchList=t.data.result,clearTimeout(this.timer),this.timer=null},300)):this.resetData()},formatHTML(t){const s=new RegExp(this.value,"g");return t.replace(s,this.value.fontcolor("red"))},saveLocalStorage(t){const s=this.historyList.find(s=>s.value===t);s?(s.time=(new Date).getTime(),this.historyList.sort((t,s)=>s.time-t.time)):this.historyList.unshift({time:(new Date).getTime(),value:t}),localStorage.setItem("searchHistory",JSON.stringify(this.historyList))}},created(){const t=JSON.parse(localStorage.getItem("searchHistory"))||[];this.historyList=t}},g=p,m=(e("cc09"),Object(u["a"])(g,i,a,!1,null,"79ef76cf",null));s["default"]=m.exports},"56f8":function(t,s,e){},ae8d:function(t,s,e){"use strict";var i=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"card"}},[s("div",{staticClass:"card-img"},[s("img",{ref:"img",attrs:{src:t.data.images[0]}})]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"title van-ellipsis"},[t._v(t._s(t.data.title))]),s("div",{staticClass:"desc van-ellipsis"},[t._v(t._s(t.data.desc))]),s("div",{staticClass:"tags van-ellipsis"},t._l(t.data.tags,(function(e,i){return s("div",{key:i,staticClass:"tags-item"},[t._v(" "+t._s(e)+" ")])})),0),s("div",{staticClass:"price"},[t._v("￥"+t._s(t.data.price))]),s("div",{staticClass:"count"},[t.counterMap[t.data.id]?s("div",{on:{click:function(s){return t.countNum(-1)}}},[s("img",{attrs:{src:"https://duyi-bucket.oss-cn-beijing.aliyuncs.com/img/rec.png",alt:""}})]):t._e(),t.counterMap[t.data.id]?s("div",{staticClass:"num"},[t._v(" "+t._s(t.counterMap[t.data.id])+" ")]):t._e(),s("div",{on:{click:function(s){return t.countNum(1)}}},[s("img",{attrs:{src:"https://duyi-bucket.oss-cn-beijing.aliyuncs.com/img/add.png",alt:""}})])])])])},a=[],o=e("2f62"),n=e("2b0e"),r=function(){var t=this,s=t._self._c;return t.exist?s("div",{style:{width:t.width+"px",height:t.height+"px",opacity:t.opacity,transform:`translate(${t.moveX}px, ${t.moveY}px) scale(${t.sx},${t.sy})`},attrs:{id:"item"}},[s("img",{attrs:{src:t.src,alt:""}})]):t._e()},c=[],l={},h=l,d=(e("129d"),e("2877")),u=Object(d["a"])(h,r,c,!1,null,"f8e6bbe8",null),f=u.exports;const v=n["a"].extend(f);var p=function({startX:t,startY:s,endX:e,endY:i,src:a,width:o,height:n}){const r=new v({el:document.createElement("div"),data(){return{moveX:t,moveY:s,sx:1,sy:1,opacity:1,exist:!0,src:a,width:o,height:n}}});document.body.appendChild(r.$el),setTimeout(()=>{r.moveX=e,r.moveY=i,r.sx=.1,r.sy=.1,r.opacity=0},0),setTimeout(()=>{r.exist=!1},1100)},g={props:["data","noFly","needNum"],data(){return{}},computed:{...Object(o["b"])(["counterMap"])},created(){},methods:{countNum(t){const{id:s}=this.data,e=this.counterMap[this.data.id];if(1===e&&-1===t&&this.needNum)return void this.$emit("noMore",e);if(this.$store.commit("saveLocalStorage",{id:s,value:t}),-1===t||this.noFly)return;const{left:i,top:a}=this.$refs.img.getBoundingClientRect(),{offsetWidth:o,offsetHeight:n}=this.$refs.img,r=document.getElementById("shop-car"),{left:c,top:l}=r.getBoundingClientRect(),{offsetWidth:h,offsetHeight:d}=r,u=c+h/2,f=l+d/2;p({startX:i,startY:a,endX:u,endY:f,src:this.$refs.img.src,width:o,height:n})}}},m=g,y=(e("381e"),Object(d["a"])(m,i,a,!1,null,null,null));s["a"]=y.exports},cc09:function(t,s,e){"use strict";e("fc3f")},dc55:function(t,s,e){},e5a8:function(t,s,e){"use strict";e("0fb7")},fc3f:function(t,s,e){}}]);
//# sourceMappingURL=chunk-3d3f0bae.31675130.js.map